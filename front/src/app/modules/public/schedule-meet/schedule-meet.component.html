<mat-card class="m-2">
    <mat-stepper [linear]="true" orientation="vertical">
        <mat-step [stepControl]="firstForm">
            <ng-template matStepLabel>Datos Personales</ng-template>
            <ng-template matStepContent>
                <form [formGroup]="firstForm">
                    <mat-form-field>
                        <mat-label>Rut</mat-label>
                        <input matInput type="text" formControlName="rut" formatRut validateRut maxlength="12">
                    </mat-form-field>
                    <br>
                    <mat-form-field>
                        <mat-label>Nombre</mat-label>
                        <input matInput formControlName="firstName" maxlength="60">
                    </mat-form-field>
                    <br>
                    <mat-form-field>
                        <mat-label>Apellidos</mat-label>
                        <input matInput formControlName="lastName" maxlength="60">
                    </mat-form-field>
                    <br>
                    <mat-form-field>
                        <mat-label>Edad</mat-label>
                        <input matInput type="number" formControlName="age" maxlength="2" appNumericOnly>
                    </mat-form-field>
                    <br>
                    <mat-form-field>
                        <mat-label>Email</mat-label>
                        <input matInput type="email" formControlName="email" maxlength="60">
                    </mat-form-field>
                    <br>
                    <mat-form-field>
                        <mat-label>Celular</mat-label>
                        <input matInput formControlName="cellphone" maxlength="9" appNumericOnly>
                    </mat-form-field>
                    <br>
                    
                    <button mat-button matStepperNext>Continuar</button>
                </form>        
            </ng-template>
        </mat-step>
        <mat-step [stepControl]="secondForm">
            <ng-template matStepLabel>Agendar Cita</ng-template>
            <ng-template matStepContent>
            <form [formGroup]="secondForm">
                <mat-calendar [(selected)]="selectedDate" (selectedChange)="selectDate($event)"></mat-calendar>
                <br>
                <mat-label>Horas Disponibles para: <strong>{{selectedDate | date:'dd-MM-yyyy'}}</strong></mat-label>
                <mat-progress-bar mode="indeterminate" *ngIf="isLoading"></mat-progress-bar>
                <mat-chip-listbox aria-label="Hour Selection">
                    <ng-container *ngIf="availableHours.length; else empty">
                        <mat-chip-option *ngFor="let hour of availableHours" (selectionChange)="selectHour(hour, $event)">
                            <span>{{hour.value}}</span>
                        </mat-chip-option>
                    </ng-container>
                    <ng-template #empty>
                        <mat-chip>No hay horas disponibles.</mat-chip>
                    </ng-template>
                </mat-chip-listbox>
                <br>
                <button mat-button matStepperPrevious>Volver</button>
                <button mat-button matStepperNext [disabled]="!isSelectedHour">Continuar</button>
            </form>        
            </ng-template>
        </mat-step>
        <mat-step [stepControl]="thirdForm">
            <ng-template matStepLabel>Resumen</ng-template>
            <ng-template matStepContent>
                <form [formGroup]="thirdForm">
                    <p>Has seleccionado una cita para el día <strong>{{ selectedDate | date:'dd-MM-yyyy' }}</strong> a las <strong>{{ selectedHour }}</strong>.</p>
                    <br>
                    <p>El valor de la sesión es de: <b>$14.990</b></p>
                    <br>
                    <mat-checkbox formControlName="termsControl" required>Acepto los <a href="#">T&eacute;rminos y Condiciones</a></mat-checkbox>
                    <mat-error *ngIf="thirdForm.controls['termsControl'].invalid">{{getErrorMessage()}}</mat-error>
                    <br>
                    <button mat-button (click)="createPayment()">Pagar</button>
                </form>
            </ng-template>
        </mat-step>
    </mat-stepper>
</mat-card>